<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bot Control - Local</title>
  <link rel="stylesheet" href="/shared.css">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 18px; }
    .card { border: 1px solid #ddd; padding: 12px; border-radius: 8px; max-width: 820px; margin-bottom: 12px; }
    .row { display:flex; gap:8px; align-items:center; margin-bottom:8px; }
    input[type=text], input[type=password] { flex:1; padding:8px; border:1px solid #ccc; border-radius:4px; }
    button { padding:8px 12px; border-radius:6px; border: none; background: var(--owner-color, #1e90ff); color: white; cursor:pointer; }
    button.secondary { background: #555; }
    pre { background:#f6f6f6; padding:8px; border-radius:6px; max-height:240px; overflow:auto; }
    table { width:100%; border-collapse:collapse; }
    td, th { padding:6px; border-bottom:1px solid #eee; text-align:left }
  </style>
</head>
<body>
  <h2>Bot Control (localhost)</h2>

  <div class="card">
    <div><strong>Backend de control</strong> <small>(URL y API key que recibirá el servidor)</small></div>
    <div class="row">
      <input id="backend_url" type="text" placeholder="https://mi-backend" />
      <input id="backend_key" type="password" placeholder="API key (Bearer)" />
      <button id="btn_save_backend">Guardar</button>
    </div>
    <div style="font-size:0.9rem;color:#555">Se usará para todas las llamadas /bot/* y /processes/* desde esta web local.</div>
  </div>

  <div class="card">
    <div><strong>Registrar / Verificar token de Bot</strong></div>
    <div class="row">
      <input id="token" type="password" placeholder="Bot token (ej: 123456:ABC-... )" />
      <input id="dev_id" type="text" placeholder="Device id (opcional)" />
      <input id="dev_name" type="text" placeholder="Name (opcional)" />
      <button id="btn_verify">Verify & Register</button>
    </div>
    <div class="row">
      <button id="btn_add" class="secondary">Add device (no verify)</button>
      <button id="btn_refresh" class="secondary">Refresh accounts</button>
    </div>
    <div id="verify_res"></div>
  </div>

  <div class="card">
    <div><strong>Cuentas registradas</strong> <small>(desde Redis `web:devices`)</small></div>
    <div id="accounts_container">Cargando...</div>
  </div>

  <div class="card">
    <div><strong>Control de proceso</strong></div>
    <div class="row">
      <button id="btn_start">Start python_bot</button>
      <button id="btn_stop" class="secondary">Stop python_bot</button>
      <button id="btn_processes" class="secondary">Refresh processes</button>
    </div>
    <div id="process_res"></div>
  </div>

  <script src="/bot_control.js"></script>
</body>
</html>
